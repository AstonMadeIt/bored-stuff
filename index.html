<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>i wuz just bored</title>

  <!-- Favicon & Fonts -->
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>âœ¨</text></svg>" />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700;800&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet" />

  <!-- Plotly + GSAP -->
  <script src="https://cdn.plot.ly/plotly-2.32.0.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/gsap@3.12.5/dist/gsap.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/gsap@3.12.5/dist/ScrollTrigger.min.js"></script>

  <style>
    :root{
      --bg:#000; --fg:#fff; --fg-muted:#d1d5db;
      --story-bg:#fff; --story-ink:#0a0a0a; --story-sub:#60636a;
      --accent:#6366f1; --accent-hover:#818cf8;
      --pad:clamp(16px,4vw,60px); --max-width:1400px; --content-width:65ch;
      --space-xs:clamp(8px,2vw,16px); --space-sm:clamp(12px,3vw,24px);
      --space-md:clamp(20px,4vw,40px); --space-lg:clamp(32px,6vw,80px);
      --space-xl:clamp(48px,10vw,140px); --space-2xl:clamp(80px,15vw,200px);

      /* Distinct series colors */
      --c-tradwife:#f97316; --c-measles:#dc2626; --c-unemployment:#2563eb;
      --c-eggs:#0ea5e9; --c-gold:#d97706; --c-beef:#7c2d12;
    }

    *{ box-sizing:border-box; margin:0; padding:0; }
    html{ 
      font-size:16px; scroll-behavior:smooth; 
      -webkit-font-smoothing:antialiased; 
      -moz-osx-font-smoothing:grayscale;
      text-size-adjust:100%; 
    }
    body{
      background:var(--bg); color:var(--fg);
      font-family:'Space Grotesk', -apple-system, system-ui, sans-serif;
      line-height:1.6; overflow-x:hidden; min-height:100vh;
      padding-bottom:env(safe-area-inset-bottom, 0);
    }

    /* ===== BACKGROUNDS ===== */
    .bg-stars,.bg-grit,.bg-paper,.bg-vignette{ 
      position:fixed; inset:0; pointer-events:none; 
    }
    .bg-stars{ 
      z-index:1; will-change:transform, opacity; 
    }
    .bg-stars picture,.bg-stars img{ 
      width:100%; height:100%; display:block; 
    }
    .bg-stars img{ 
      object-fit:cover; 
      filter:brightness(.85) contrast(1.1); 
    }
    .bg-grit{ 
      z-index:2; mix-blend-mode:screen; opacity:.08; 
      background-size:1200px; background-repeat:repeat; 
    }
    .bg-paper{ 
      z-index:3; mix-blend-mode:overlay; opacity:.06; 
      background-size:1400px; background-repeat:repeat; 
    }
    .bg-vignette{ 
      z-index:4; 
      background:radial-gradient(ellipse,transparent 0%,transparent 50%,rgba(0,0,0,.4) 100%); 
    }

    /* ===== PROGRESS BAR ===== */
    .progress-bar {
      position: fixed;
      top: 0;
      left: 0;
      height: 3px;
      background: linear-gradient(90deg, var(--accent), var(--accent-hover));
      z-index: 200;
      transform-origin: left;
      transform: scaleX(0);
      will-change: transform;
    }

    /* ===== HEADER ===== */
    header{
      position:fixed; top:0; left:0; right:0; z-index:100;
      padding:max(20px, env(safe-area-inset-top)) var(--pad) 20px var(--pad);
      background:linear-gradient(180deg, rgba(0,0,0,.95) 0%, rgba(0,0,0,.7) 60%, transparent 100%);
      backdrop-filter:blur(12px);
      transition: background 0.3s ease;
    }
    header.scrolled {
      background:rgba(0,0,0,.98);
      box-shadow: 0 4px 24px rgba(0,0,0,.4);
    }
    .brand{
      font-weight:700; font-size:clamp(14px,3.5vw,20px);
      letter-spacing:.28em; text-transform:uppercase; color:rgba(255,255,255,.95);
      text-shadow:0 2px 12px rgba(0,0,0,.8), 0 4px 20px rgba(0,0,0,.5);
      transition: letter-spacing 0.3s ease;
    }
    .brand:hover {
      letter-spacing:.32em;
    }

    /* ===== MAIN ===== */
    main{ 
      position:relative; z-index:10; min-height:100vh; 
      padding:calc(80px + var(--space-lg)) var(--pad) var(--space-xl); 
    }
    .container{ max-width:var(--max-width); margin:0 auto; }

    /* ===== HERO ===== */
    .hero{
      min-height:clamp(500px,80vh,700px); 
      display:flex; flex-direction:column; justify-content:center;
      padding:var(--space-xl) 0; position:relative; 
      margin-bottom:var(--space-2xl);
    }
    .hero::before{
      content:''; position:absolute; inset:-40px; z-index:-1;
      background:radial-gradient(ellipse 100% 100% at 50% 50%, rgba(0,0,0,.9) 0%, rgba(0,0,0,.6) 40%, transparent 100%);
    }
    .hero-title{
      font-weight:800; font-size:clamp(2.5rem,11vw,7.5rem); 
      line-height:.95; letter-spacing:-.03em;
      margin-bottom:var(--space-md); max-width:var(--content-width); 
      margin-inline:auto; text-align:center;
      text-shadow:0 0 80px rgba(99,102,241,.3), 0 4px 24px rgba(0,0,0,.9), 0 8px 40px rgba(0,0,0,.7);
      opacity: 0;
      transform: translateY(30px);
    }
    .hero-subtitle{
      font-size:clamp(1.05rem,3.8vw,1.5rem); 
      line-height:1.5; font-weight:400; color:var(--fg-muted);
      max-width:var(--content-width); margin-inline:auto; text-align:center; 
      text-shadow:0 2px 16px rgba(0,0,0,.9);
      opacity: 0;
      transform: translateY(20px);
    }

    /* ===== VOICE MOMENT (NEW) ===== */
    .voice-moment {
      max-width: var(--content-width);
      margin: var(--space-2xl) auto;
      padding: var(--space-lg) var(--space-md);
      background: rgba(99, 102, 241, 0.05);
      border-left: 4px solid var(--accent);
      border-radius: 8px;
      position: relative;
      opacity: 0;
      transform: translateY(20px);
    }
    .voice-moment::before {
      content: 'ðŸ’­';
      position: absolute;
      top: -20px;
      left: 20px;
      font-size: 2rem;
      filter: grayscale(0.3);
    }
    .voice-label {
      font-size: 0.75rem;
      font-weight: 700;
      letter-spacing: 0.12em;
      text-transform: uppercase;
      color: var(--accent);
      margin-bottom: 0.75rem;
    }
    .voice-text {
      font-family: 'Inter', sans-serif;
      font-size: clamp(1rem, 3vw, 1.15rem);
      line-height: 1.7;
      color: var(--fg);
      font-weight: 400;
    }
    .voice-text strong {
      color: var(--accent-hover);
      font-weight: 600;
    }

    /* ===== STORY CARDS ===== */
    .story-card{
      padding:clamp(40px,7vw,70px) clamp(32px,6vw,60px);
      margin:0 0 calc(var(--space-xl)*1.5) 0; 
      background:var(--story-bg);
      border-radius:clamp(20px,4vw,28px);
      box-shadow:0 30px 90px rgba(0,0,0,.5), 0 10px 30px rgba(0,0,0,.3), 
                 inset 0 1px 0 rgba(255,255,255,.8);
      transition: transform 0.4s cubic-bezier(0.16, 1, 0.3, 1),
                  box-shadow 0.4s cubic-bezier(0.16, 1, 0.3, 1);
      opacity: 0;
      transform: translateY(40px);
    }
    .story-card:hover {
      transform: translateY(-8px);
      box-shadow:0 40px 100px rgba(0,0,0,.6), 0 20px 40px rgba(0,0,0,.4), 
                 inset 0 1px 0 rgba(255,255,255,.9);
    }
    
    .story-header{
      border-bottom:1.5px solid var(--story-ink);
      padding-bottom:var(--space-md); margin-bottom:var(--space-lg);
      max-width:var(--content-width); margin-inline:auto;
    }
    .story-kicker{ 
      font-size:clamp(10px,2.2vw,12px); font-weight:700; 
      letter-spacing:.14em; text-transform:uppercase; 
      color:var(--story-sub); margin-bottom:clamp(10px,2vw,12px); 
    }
    .story-title{ 
      font-weight:700; font-size:clamp(2.2rem,7vw,4.8rem); 
      line-height:1.02; letter-spacing:-.02em; 
      margin-bottom:var(--space-sm); color:var(--story-ink); 
    }
    .story-subtitle{ 
      font-size:clamp(.95rem,3vw,1.15rem); 
      line-height:1.55; font-weight:400; 
      color:var(--story-sub); margin-bottom:var(--space-sm); 
    }
    .story-byline{ 
      font-size:clamp(.75rem,2.5vw,.85rem); 
      font-weight:300; color:#8a8d93; margin-top:10px; 
    }
    .story-lede{
      color:#2b2e33; font-size:clamp(1.05rem,3.5vw,1.25rem); 
      line-height:1.7; font-weight:400;
      margin:var(--space-lg) auto var(--space-xl) auto; 
      max-width:var(--content-width);
    }
    .story-chart{ 
      width:100%; height:auto; 
      min-height:clamp(600px,80vh,900px); 
      max-height:1000px; margin:var(--space-xl) 0; 
    }
    .story-notes{
      background:#f6f7f8; border-left:3px solid var(--story-ink);
      padding:clamp(16px,3vw,20px); 
      margin:var(--space-lg) auto var(--space-md) auto;
      font-size:clamp(.8rem,2.5vw,.88rem); 
      line-height:1.6; color:#444; border-radius:6px; 
      max-width:var(--content-width);
    }
    .story-source{ 
      font-size:clamp(.75rem,2.2vw,.82rem); 
      font-style:italic; font-weight:300; color:#8a8d93; 
      margin:var(--space-sm) auto 0; max-width:var(--content-width); 
    }

    /* ===== TOGGLES ===== */
    .metric-toggles{
      display:flex; flex-wrap:wrap; gap:10px; 
      margin:var(--space-lg) auto; max-width:var(--content-width);
      position:sticky; top:calc(64px + 8px); z-index:20;
    }
    .metric-btn{
      padding:12px 20px; border-radius:24px; 
      font-size:clamp(.78rem,2.5vw,.92rem); font-weight:600;
      border:none; cursor:pointer; font-family:inherit;
      transition: all 0.3s cubic-bezier(0.16, 1, 0.3, 1);
      box-shadow: 0 4px 12px rgba(0,0,0,.15);
    }
    .metric-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(0,0,0,.25);
    }
    .metric-btn:active {
      transform: translateY(0);
    }
    .metric-btn.active{
      box-shadow: 0 6px 16px rgba(0,0,0,.3);
    }

    /* ===== BACK TO TOP BUTTON ===== */
    .back-to-top {
      position: fixed;
      bottom: 40px;
      right: 40px;
      width: 56px;
      height: 56px;
      border-radius: 50%;
      background: rgba(99, 102, 241, 0.95);
      border: none;
      cursor: pointer;
      z-index: 150;
      opacity: 0;
      pointer-events: none;
      transition: all 0.4s cubic-bezier(0.16, 1, 0.3, 1);
      box-shadow: 0 8px 24px rgba(99, 102, 241, 0.3);
    }
    .back-to-top.visible {
      opacity: 1;
      pointer-events: all;
    }
    .back-to-top:hover {
      transform: translateY(-4px) scale(1.05);
      box-shadow: 0 12px 32px rgba(99, 102, 241, 0.4);
      background: rgba(129, 140, 248, 0.95);
    }
    .back-to-top:active {
      transform: translateY(-2px) scale(1.02);
    }
    
    /* Progress ring */
    .progress-ring {
      position: absolute;
      top: 0;
      left: 0;
      width: 56px;
      height: 56px;
      transform: rotate(-90deg);
    }
    .progress-ring-circle {
      fill: none;
      stroke: rgba(255, 255, 255, 0.3);
      stroke-width: 3;
    }
    .progress-ring-progress {
      fill: none;
      stroke: #fff;
      stroke-width: 3;
      stroke-linecap: round;
      transition: stroke-dashoffset 0.1s linear;
    }
    
    /* Arrow icon */
    .back-to-top-arrow {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 24px;
      height: 24px;
      stroke: #fff;
      stroke-width: 2;
      stroke-linecap: round;
      stroke-linejoin: round;
      fill: none;
    }

    /* ===== PIP VIDEO PLACEHOLDER ===== */
    .pip-video-container {
      position: fixed;
      bottom: 120px;
      right: 40px;
      width: 320px;
      height: 180px;
      background: rgba(0, 0, 0, 0.95);
      border-radius: 12px;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.6);
      z-index: 140;
      opacity: 0;
      pointer-events: none;
      transition: all 0.4s cubic-bezier(0.16, 1, 0.3, 1);
      overflow: hidden;
    }
    .pip-video-container.active {
      opacity: 1;
      pointer-events: all;
    }
    .pip-video-container:hover {
      transform: scale(1.02);
      box-shadow: 0 24px 80px rgba(0, 0, 0, 0.7);
    }
    .pip-close {
      position: absolute;
      top: 8px;
      right: 8px;
      width: 28px;
      height: 28px;
      background: rgba(255, 255, 255, 0.2);
      border: none;
      border-radius: 50%;
      cursor: pointer;
      z-index: 10;
      transition: all 0.2s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #fff;
      font-size: 18px;
      line-height: 1;
    }
    .pip-close:hover {
      background: rgba(255, 255, 255, 0.3);
      transform: rotate(90deg);
    }

    /* ===== MOBILE OPTIMIZATIONS ===== */
    @media (max-width: 768px) {
      .back-to-top {
        bottom: 24px;
        right: 24px;
        width: 48px;
        height: 48px;
      }
      .progress-ring {
        width: 48px;
        height: 48px;
      }
      .back-to-top-arrow {
        width: 20px;
        height: 20px;
      }
      .pip-video-container {
        width: 280px;
        height: 158px;
        bottom: 90px;
        right: 24px;
      }
      .voice-moment {
        margin: var(--space-xl) auto;
      }
    }

    @media (max-width: 480px) {
      .pip-video-container {
        width: calc(100vw - 48px);
        height: auto;
        aspect-ratio: 16/9;
        right: 24px;
      }
    }
  </style>
</head>
<body>

  <!-- Progress Bar -->
  <div class="progress-bar"></div>

  <!-- Backgrounds -->
  <div class="bg-stars">
    <picture>
      <source type="image/webp" srcset="https://images.unsplash.com/photo-1462331940025-496dfbfc7564?w=2400&q=80&fm=webp">
      <img src="https://images.unsplash.com/photo-1462331940025-496dfbfc7564?w=2400&q=80" alt="" loading="eager">
    </picture>
  </div>
  <div class="bg-grit" style="background-image:url('data:image/svg+xml;utf8,<svg xmlns=%22http://www.w3.org/2000/svg%22 width=%22300%22 height=%22300%22><filter id=%22n%22><feTurbulence baseFrequency=%22.9%22 numOctaves=%224%22 /><feColorMatrix values=%220 0 0 0 0, 0 0 0 0 0, 0 0 0 0 0, 0 0 0 1 0%22/></filter><rect width=%22100%%22 height=%22100%%22 filter=%22url(%23n)%22/></svg>');"></div>
  <div class="bg-paper" style="background-image:url('data:image/svg+xml;utf8,<svg xmlns=%22http://www.w3.org/2000/svg%22 width=%22400%22 height=%22400%22><filter id=%22p%22><feTurbulence baseFrequency=%22.04%22 numOctaves=%223%22 seed=%2215%22/><feDisplacementMap in=%22SourceGraphic%22 scale=%2210%22/></filter><rect width=%22100%%22 height=%22100%%22 fill=%22%23fff%22 filter=%22url(%23p)%22 opacity=%22.4%22/></svg>');"></div>
  <div class="bg-vignette"></div>

  <!-- Header -->
  <header>
    <div class="brand">i wuz just bored</div>
  </header>

  <!-- Back to Top Button -->
  <button class="back-to-top" aria-label="Back to top">
    <svg class="progress-ring">
      <circle class="progress-ring-circle" cx="28" cy="28" r="24"></circle>
      <circle class="progress-ring-progress" cx="28" cy="28" r="24"></circle>
    </svg>
    <svg class="back-to-top-arrow" viewBox="0 0 24 24">
      <polyline points="18 15 12 9 6 15"></polyline>
    </svg>
  </button>

  <!-- PIP Video Container (placeholder for future use) -->
  <div class="pip-video-container">
    <button class="pip-close" aria-label="Close video">Ã—</button>
    <!-- Video will be injected here via JS when ready -->
    <div style="display:flex; align-items:center; justify-content:center; height:100%; color:#888; font-size:14px;">
      PIP Video Ready
    </div>
  </div>

  <!-- Main Content -->
  <main>
    <div class="container">

      <!-- Hero -->
      <section class="hero">
        <h1 class="hero-title">When Boredom Strikes...<br>Data Bites.</h1>
        <p class="hero-subtitle">
          Data stories from the edge of attention. When boredom meets obsession, 
          the questions get interesting. No manifesto. No roadmap. Just signal.
        </p>
      </section>

      <!-- Voice Moment 1 -->
      <div class="voice-moment">
        <div class="voice-label">The Take</div>
        <p class="voice-text">
          Everyone's talking about the loneliness epidemic. <strong>Nobody's connecting the dots.</strong> 
          We're not just lonelyâ€”we're medicated, distracted, and optimizing ourselves into isolation. 
          The data doesn't lie: sex is down, screens are up, and we're buying gold like the world's ending. 
          Maybe it's not ending. Maybe we're just <em>bored</em>.
        </p>
      </div>

      <!-- Story 1: Intimacy Recession -->
      <article class="story-card">
        <div class="story-header">
          <div class="story-kicker">DATA DABS</div>
          <h2 class="story-title">The Intimacy Recession</h2>
          <div class="story-subtitle">
            How declining sexual frequency, rising pharmaceutical use, and increasing 
            screen time tell the story of American isolation
          </div>
          <div class="story-byline">
            By The Slang Editorial Â· Analysis based on GSS, Census Bureau, and Express Scripts data
          </div>
        </div>

        <div class="story-lede">
          Between 2000 and 2022, average sexual frequency among American adults ages 18â€“64 
          declined from approximately 62 times per year to 41 times per year â€” a 34% decrease. 
          During the same period, SSRI prescriptions more than doubled, from 164 million to 408 million annually.
        </div>

        <div id="intimacy-chart" class="story-chart"></div>

        <div class="story-notes">
          <strong>About the data:</strong> Sexual frequency data comes from the General Social Survey (GSS),
          conducted by NORC at the University of Chicago. SSRI prescription data: Express Scripts Drug Trend Reports.
          Marriage data via U.S. Census API. Screen time estimates from Nielsen Total Audience Reports and Pew Research.
        </div>

        <div class="story-source">
          <strong>Methodology:</strong> Python Â· Pandas Â· Plotly. Pipelines unchanged; this build applies typography and chart cosmetics only.
        </div>
      </article>

      <!-- Voice Moment 2 -->
      <div class="voice-moment">
        <div class="voice-label">Pattern Recognition</div>
        <p class="voice-text">
          When measles cases spike at the same time "tradwife" searches explode, that's not a coincidenceâ€”
          <strong>it's a signal.</strong> We're not just tracking metrics. We're watching a culture 
          retreat from modernity in real-time. Gold up. Trust down. The Analog Anxiety Index is my 
          attempt to measure what everyone feels but nobody's quantifying.
        </p>
      </div>

      <!-- Story 2: Analog Anxiety -->
      <article class="story-card">
        <div class="story-header">
          <div class="story-kicker">DATA DABS</div>
          <h2 class="story-title">The Analog Anxiety Index</h2>
          <div class="story-subtitle">
            Cultural signals, public health, and economic indicators converging since 2020
          </div>
          <div class="story-byline">
            By The Slang Editorial Â· Six trends normalized 0â€“100
          </div>
        </div>

        <div class="story-lede">
          "Tradwife" searches peaked mid-2024. 1,698 measles cases in 2025â€”highest in 30+ years. 
          Eggs hit $4.50/dozen. Gold reached $2.79k/oz. Six trends that tell the same story.
        </div>

        <div class="metric-toggles" id="anxiety-toggles" role="group" aria-label="Toggle data series"></div>
        <div id="anxiety-chart" class="story-chart"></div>

        <div class="story-notes">
          <strong>About the series:</strong> All data normalized 0â€“100 for comparison. 
          Sources: Google Trends, CDC measles surveillance, BLS unemployment & CPI, FRED gold prices.
          This is descriptive, not causalâ€”correlation doesn't imply causation, but patterns matter.
        </div>
      </article>

      <!-- Voice Moment 3 -->
      <div class="voice-moment">
        <div class="voice-label">The Point</div>
        <p class="voice-text">
          <strong>We're all fucked up.</strong> Sold a bill of goods. Turning into crabs in a barrel. 
          But here's the thing: <em>sex, love, and laughter are still beautiful.</em> That's not naÃ¯veâ€”
          it's the data. Connection still matters. Joy still works. And if you zoom out far enough, 
          the chaos starts to make sense. That's the game.
        </p>
      </div>

    </div>
  </main>

  <script>
    // ===== GSAP SETUP =====
    gsap.registerPlugin(ScrollTrigger);

    // ===== PROGRESS BAR =====
    const progressBar = document.querySelector('.progress-bar');
    window.addEventListener('scroll', () => {
      const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
      const scrollHeight = document.documentElement.scrollHeight - document.documentElement.clientHeight;
      const scrollPercentage = (scrollTop / scrollHeight);
      gsap.to(progressBar, { scaleX: scrollPercentage, duration: 0.1 });
    });

    // ===== HEADER SCROLL STATE =====
    const header = document.querySelector('header');
    window.addEventListener('scroll', () => {
      if (window.scrollY > 100) {
        header.classList.add('scrolled');
      } else {
        header.classList.remove('scrolled');
      }
    });

    // ===== HERO ENTRANCE ANIMATION =====
    gsap.to('.hero-title', { opacity: 1, y: 0, duration: 1.2, ease: 'power3.out', delay: 0.3 });
    gsap.to('.hero-subtitle', { opacity: 1, y: 0, duration: 1, ease: 'power3.out', delay: 0.6 });

    // ===== STORY CARDS SCROLL REVEAL =====
    gsap.utils.toArray('.story-card').forEach(card => {
      gsap.to(card, {
        scrollTrigger: {
          trigger: card,
          start: 'top 85%',
          toggleActions: 'play none none none'
        },
        opacity: 1,
        y: 0,
        duration: 0.8,
        ease: 'power2.out'
      });
    });

    // ===== VOICE MOMENTS SCROLL REVEAL =====
    gsap.utils.toArray('.voice-moment').forEach(moment => {
      gsap.to(moment, {
        scrollTrigger: {
          trigger: moment,
          start: 'top 85%',
          toggleActions: 'play none none none'
        },
        opacity: 1,
        y: 0,
        duration: 0.8,
        ease: 'power2.out'
      });
    });

    // ===== BACK TO TOP BUTTON WITH PROGRESS RING =====
    const backToTop = document.querySelector('.back-to-top');
    const progressRing = document.querySelector('.progress-ring-progress');
    const radius = 24;
    const circumference = 2 * Math.PI * radius;
    
    progressRing.style.strokeDasharray = circumference;
    progressRing.style.strokeDashoffset = circumference;

    window.addEventListener('scroll', () => {
      const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
      const scrollHeight = document.documentElement.scrollHeight - document.documentElement.clientHeight;
      const scrollPercentage = scrollTop / scrollHeight;
      
      // Show/hide button
      if (scrollTop > 500) {
        backToTop.classList.add('visible');
      } else {
        backToTop.classList.remove('visible');
      }
      
      // Update progress ring
      const offset = circumference - (scrollPercentage * circumference);
      progressRing.style.strokeDashoffset = offset;
    });

    backToTop.addEventListener('click', () => {
      window.scrollTo({ top: 0, behavior: 'smooth' });
    });

    // ===== MAGNETIC HOVER EFFECT ON BACK TO TOP =====
    if (window.innerWidth > 768) {
      backToTop.addEventListener('mousemove', (e) => {
        const rect = backToTop.getBoundingClientRect();
        const x = e.clientX - rect.left - rect.width / 2;
        const y = e.clientY - rect.top - rect.height / 2;
        gsap.to(backToTop, { x: x * 0.3, y: y * 0.3, duration: 0.3 });
      });
      
      backToTop.addEventListener('mouseleave', () => {
        gsap.to(backToTop, { x: 0, y: 0, duration: 0.3 });
      });
    }

    // ===== PARALLAX STARS (SUBTLE) =====
    (function(){
      const starImg = document.querySelector('.bg-stars img');
      if (!starImg || window.innerWidth <= 768) return;
      let tx = 0, ty = 0, cx = 0, cy = 0;
      window.addEventListener('mousemove', e => {
        tx = (e.clientX / window.innerWidth - 0.5) * 15;
        ty = (e.clientY / window.innerHeight - 0.5) * 15;
      });
      gsap.ticker.add(() => { 
        cx += (tx - cx) * 0.05; 
        cy += (ty - cy) * 0.05; 
        gsap.set(starImg, { x: cx, y: cy }); 
      });
    })();

    // ===== STORY 1: INTIMACY RECESSION =====
    const intimacyData = {"data":[
      {"hovertemplate":"%{y:.0f} times/year<extra></extra>","line":{"color":"#FF3333","width":4},"marker":{"color":"#FF3333","size":8},"mode":"lines+markers","name":"Sexual frequency","x":[2000,2002,2004,2006,2008,2010,2012,2014,2016,2018,2021,2022,2024],"y":[66.98,67.70,64.02,61.05,63.82,59.00,78.18,58.33,55.38,58.60,50.13,54.34,49.53],"type":"scatter","xaxis":"x","yaxis":"y"},
      {"hovertemplate":"%{y:.0f}M<extra></extra>","line":{"color":"#0066CC","dash":"dot","width":4},"marker":{"color":"#0066CC","size":8,"symbol":"diamond"},"mode":"lines+markers","name":"SSRI prescriptions","x":[2000,2002,2004,2006,2008,2010,2012,2014,2016,2018,2020,2022],"y":[164,180,196,215,232,264,286,308,330,352,380,408],"type":"scatter","xaxis":"x","yaxis":"y2"},
      {"fill":"tozeroy","fillcolor":"rgba(0, 102, 204, 0.1)","hovertemplate":"%{y:.1f}%<extra></extra>","line":{"color":"#0066CC","width":4},"marker":{"color":"#0066CC","size":8},"mode":"lines+markers","name":"Marriage rate","showlegend":false,"x":[2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2021,2022],"y":[48.76,48.28,48.02,47.86,47.72,47.54,47.50,47.80,47.75,47.62,48.04,48.02],"type":"scatter","xaxis":"x2","yaxis":"y3"},
      {"fill":"tozeroy","fillcolor":"rgba(0,0,0,0.1)","hovertemplate":"%{y:.1f} hours<extra></extra>","line":{"color":"#000","width":4},"marker":{"color":"#000","size":8},"mode":"lines+markers","name":"Screen time","showlegend":false,"x":[2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022],"y":[2.7,3.2,3.8,4.5,5.2,5.9,6.8,7.4,8.1,8.5,10.2,10.5,10.8],"type":"scatter","xaxis":"x3","yaxis":"y4"}
    ],
    "layout":{
      "xaxis":{"anchor":"y","domain":[0.0,0.94],"showgrid":true,"gridcolor":"rgba(0,0,0,.06)","gridwidth":0.5,"showline":true,"linewidth":1,"linecolor":"rgba(0,0,0,.25)","ticks":"outside","ticklen":5,"tickcolor":"#000","type":"linear","dtick":2,"range":[1999,2025],"zeroline":false},
      "yaxis":{"anchor":"x","domain":[0.7666666667,1.0],"showgrid":true,"gridcolor":"rgba(0,0,0,.06)","gridwidth":0.5,"showline":false,"zeroline":false,"title":{"font":{"size":12,"color":"#FF3333"},"text":"<b>Times per year</b>"},"tickfont":{"color":"#FF3333"},"range":[40,85]},
      "yaxis2":{"anchor":"x","overlaying":"y","side":"right","showgrid":true,"gridcolor":"rgba(0,0,0,.06)","gridwidth":0.5,"showline":false,"zeroline":false,"title":{"font":{"size":12,"color":"#0066CC"},"text":"<b>Millions of prescriptions</b>"},"tickfont":{"color":"#0066CC"},"range":[150,420]},
      "xaxis2":{"anchor":"y3","domain":[0.0,0.94],"showgrid":true,"gridcolor":"rgba(0,0,0,.06)","gridwidth":0.5,"showline":true,"linewidth":1,"linecolor":"rgba(0,0,0,.25)","ticks":"outside","ticklen":5,"tickcolor":"#000","type":"linear","dtick":2,"range":[1999,2025],"zeroline":false},
      "yaxis3":{"anchor":"x2","domain":[0.3833333333,0.6166666667],"showgrid":true,"gridcolor":"rgba(0,0,0,.06)","gridwidth":0.5,"showline":false,"zeroline":false,"title":{"font":{"size":12},"text":"<b>Percent married</b>"},"range":[47,49]},
      "xaxis3":{"anchor":"y4","domain":[0.0,0.94],"showgrid":true,"gridcolor":"rgba(0,0,0,.06)","gridwidth":0.5,"showline":true,"linewidth":1,"linecolor":"rgba(0,0,0,.25)","ticks":"outside","ticklen":5,"tickcolor":"#000","type":"linear","dtick":2,"range":[1999,2025],"zeroline":false},
      "yaxis4":{"anchor":"x3","domain":[0.0,0.2333333333],"showgrid":true,"gridcolor":"rgba(0,0,0,.06)","gridwidth":0.5,"showline":false,"zeroline":false,"title":{"font":{"size":12},"text":"<b>Hours per day</b>"},"range":[0,12]},
      "annotations":[
        {"font":{"color":"#000","size":14},"showarrow":false,"text":"<b>Sexual frequency has declined as SSRI prescriptions doubled</b>","x":0,"xanchor":"left","xref":"paper","y":1.0,"yanchor":"bottom","yref":"paper"},
        {"font":{"color":"#000","size":14},"showarrow":false,"text":"<b>Marriage rates have remained relatively stable</b>","x":0,"xanchor":"left","xref":"paper","y":0.6166666667,"yanchor":"bottom","yref":"paper"},
        {"font":{"color":"#000","size":14},"showarrow":false,"text":"<b>Daily screen time has quadrupled since 2010</b>","x":0,"xanchor":"left","xref":"paper","y":0.2333333333,"yanchor":"bottom","yref":"paper"}
      ],
      "font":{"family":"Space Grotesk, sans-serif","size":11,"color":"#0a0a0a"},
      "legend":{"orientation":"h","yanchor":"bottom","y":1.12,"xanchor":"left","x":0.0,"bgcolor":"rgba(255,255,255,0.85)","bordercolor":"#000","borderwidth":1},
      "margin":{"l":70,"r":70,"t":40,"b":40},
      "height": (window.innerWidth<480?520:(window.innerWidth<768?700:950)),
      "plot_bgcolor":"#fff","paper_bgcolor":"#fff","showlegend":true,
      "hoverlabel":{"font":{"size":13,"family":"Space Grotesk, sans-serif"},"bgcolor":"#fff","bordercolor":"rgba(0,0,0,.10)"},
      "hovermode":"x unified",
      "doubleClick":"reset"
    }};
    Plotly.newPlot('intimacy-chart', intimacyData.data, intimacyData.layout, { responsive:true, displayModeBar:false, showTips:false });

    // ===== STORY 2: ANALOG ANXIETY =====
    const months = Array.from({length:24}, (_,i)=>{ const m=i*3; return `${2020+Math.floor(m/12)}-${String((m%12)+1).padStart(2,'0')}`; });

    const anxietyAllData = {
      tradwife: months.map((_,i)=>Math.min(100, i<4?15+i*8 : i<10?30+Math.sin(i*0.3)*10 : 40+(i-10)*1.2)),
      measles: months.map((_,i)=>i<16?5+Math.random()*3 : 8+(i-16)*15),
      unemployment: months.map((_,i)=>i<4?20+i*15 : i<12?80-(i-4)*5 : 30-(i-12)*0.3),
      eggs: months.map((_,i)=>i<10?35+Math.sin(i*0.5)*8 : i<17?40+Math.sin(i*0.4)*10 : 50+(i-17)*3),
      gold: months.map((_,i)=>30+(i*0.8)+Math.sin(i*0.2)*5),
      beef: months.map((_,i)=>i<17?40+(i*0.3) : 50+(i-17)*1.5)
    };

    const css = k => getComputedStyle(document.documentElement).getPropertyValue(k).trim();
    const anxietyMetrics = [
      {key:'tradwife', name:'Tradwife Searches', color:css('--c-tradwife')},
      {key:'measles', name:'Measles Cases', color:css('--c-measles')},
      {key:'unemployment', name:'Unemployment', color:css('--c-unemployment')},
      {key:'eggs', name:'Egg Prices', color:css('--c-eggs')},
      {key:'gold', name:'Gold', color:css('--c-gold')},
      {key:'beef', name:'Beef', color:css('--c-beef')}
    ];

    const activeMetrics = Object.fromEntries(anxietyMetrics.map(m=>[m.key,true]));
    const togglesDiv = document.getElementById('anxiety-toggles');

    anxietyMetrics.forEach(m=>{
      const btn = document.createElement('button');
      btn.className = 'metric-btn active';
      btn.type = 'button';
      btn.textContent = m.name;
      btn.style.backgroundColor = m.color;
      btn.style.color = '#fff';
      btn.setAttribute('role','switch');
      btn.setAttribute('aria-pressed','true');
      btn.setAttribute('aria-label',`Toggle ${m.name} series`);
      btn.addEventListener('click', ()=>{
        const on = btn.getAttribute('aria-pressed') === 'true';
        btn.setAttribute('aria-pressed', String(!on));
        activeMetrics[m.key] = !on;
        if (!on){ 
          btn.classList.add('active'); 
          btn.style.backgroundColor=m.color; 
          btn.style.color='#fff'; 
        } else { 
          btn.classList.remove('active'); 
          btn.style.backgroundColor='#e5e7eb'; 
          btn.style.color='#4b5563'; 
        }
        updateAnxietyChart();
      });
      togglesDiv.appendChild(btn);
    });

    function updateAnxietyChart(){
      const traces = anxietyMetrics.filter(m=>activeMetrics[m.key]).map(m=>({
        x: months, y: anxietyAllData[m.key], name: m.name, mode:'lines',
        line:{ color:m.color, width:3, shape:'spline' }
      }));

      const layout = {
        xaxis:{ showgrid:true, gridcolor:'rgba(0,0,0,.06)', tickangle:-45 },
        yaxis:{ title:'Index (0-100)', range:[0,100] },
        annotations:[{
          text:'All series normalized 0â€“100 Â· descriptive, not causal',
          x:0, xref:'paper', xanchor:'left', y:1.12, yref:'paper', yanchor:'bottom',
          font:{ size:11, color:'#333' }, showarrow:false
        }],
        margin:{ l:60, r:40, t:50, b:80 },
        height: (window.innerWidth<480?500:(window.innerWidth<768?700:850)),
        plot_bgcolor:'#fff', paper_bgcolor:'#fff',
        font:{ family:'Space Grotesk, sans-serif', size:11 },
        legend:{ orientation:'h', x:0, y:1.12 }
      };

      Plotly.newPlot('anxiety-chart', traces, layout, { responsive:true, displayModeBar:false, showTips:false });
    }

    updateAnxietyChart();

    // ===== RESPONSIVE CHART HEIGHTS =====
    window.addEventListener('resize', ()=>{
      const h1 = (window.innerWidth<480?520:(window.innerWidth<768?700:950));
      const h2 = (window.innerWidth<480?500:(window.innerWidth<768?700:850));
      Plotly.relayout('intimacy-chart', { height:h1 });
      Plotly.relayout('anxiety-chart', { height:h2 });
    });
  </script>
</body>
</html>